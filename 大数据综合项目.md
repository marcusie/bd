
# **1.** **项目背景与功能**

## **1.1** **项目背景**

随着信息技术的快速发展和数字经济的不断壮大，软件开发、互联网服务以及新兴技术领域（如人工智能、大数据、云计算 等）的需求日益增长。这一趋势不仅推动了整个行业的扩张，同时也对专业人才提出了更高的要求。程序员作为信息时代的 核心力量，在推动技术创新和实现业务目标方面发挥着至关重要的作用。

近年来，随着企业对技术重视程度的提升，程序员相关职位的需求呈现出爆发式增长。不同规模的企业，从初创公司到大型 跨国集团，都在积极寻找具备特定技能和技术背景的编程人才。然而，面对快速变化的技术环境和激烈的市场竞争，如何准 确把握市场需求、合理评估人才价值、有效配置人力资源成为了企业和求职者共同面临的挑战。

在此背景下，开展一项关于程序员相关招聘岗位的市场分析与趋势预测的研究具有重要意义。

![](file:///C:\Users\17817\AppData\Local\Temp\ksohtml5180\wps1.jpg) 

综上所述，信息技术行业对全球经济和社会发展具有重要的贡献，中国的IT产业也在政府的支持下取得了快速发展。尽管信 息技术行业取得了显著的成就，但也面临着一些挑战和问题。市场竞争的激烈要求IT企业必须不断创新，提升产品和服务的 质量，以满足客户的需求。同时，一些过时或低效的技术路径应当被淘汰，以优化成本结构。为了进一步提升服务质量和市 场竞争力，必须深入分析行业数据，特别是程序员相关的招聘信息。

## **1.2**  **项目功能**

(1) 数据采集与处理：运用爬虫技术，从各大招聘网站精准抓取招聘信息，全面涵盖职位名称、公司名称、工作地点、发布日 期、职位类别、薪资范围、福利待遇、岗位要求、工作经验要求等众多关键字段，为后续深入分析奠定基础。对采集到的海  量数据进行深度清洗。去除重复信息，修正诸如日期格式不统一（有的是 “YYYY - MM - DD”，有的是 “MM/DD/YYYY”等）、薪资格式混乱（有的写 “X 千 - Y 千 / 月”，有的写 “XW - YW / 年”）等错误格式问题，同时对缺失值进行合理填充或 标记，确保数据的完整性和准确性，为后续分析提供高质量的数据源。

(2) 数据存储与管理：采用 HDFS 存储海量的原始招聘信息数据以及经过处理后的整洁数据，借助其强大的可靠性与高容错 性特点，确保数据不会因单点故障而丢失或损坏，为数据的长期稳定存储提供保障。运用 Hive 搭建数据仓库，按照职位类 别、发布日期、工作地点等维度对数据进行科学分区存储，极大地方便后续的数据查询、管理和分析操作，  提升数据检索效  率。使用 MySQL 存储结构化的数据，像职位基本信息、薪资明细等，充分发挥关系型数据库在复杂查询与事务处理方面的 优势，能够高效地支持如快速查询某一职位类别下某地区某时间段内的平均薪资等复杂数据需求，满足多样化数据分析场景。

(3) 数据分析与统计: 利用 Spark RDD 编程和 SparkSQL 对招聘数据展开深入的薪资水平分析，清晰呈现不同地区、不同职 位类别的薪资分布情况，为求职者提供精准的薪资参考，助力其合理评估自身期望薪资；同时也为企业制定有竞争力的薪酬 策略提供数据支持。精准分析不同时期的热门职位类别变化趋势，挖掘出新兴热门岗位以及传统热门岗位的动态变化，为求 职者指引热门求职方向；同时也为企业调整招聘计划、优化人才配置提供决策依据。

(4) 流数据处理与分析：借助 Spark Streaming 或 Structured Streaming 进行实时流数据处理，实时监测热门职位的投递 动态以及企业招聘进度。当某一职位短时间内收到的简历数量大幅增加时，及时调整推荐算法，将该职位更精准地推送给符  合条件但尚未投递简历的求职者，提升招聘平台的匹配效率。为企业提供实时的招聘热度反馈，提醒企业关注简历筛选进度，及时调整招聘策略，避免错过优秀人才，优化招聘流程，提升招聘效率，确保招聘工作顺利推进。

(5) 机器学习与预测分析：运用 Spark MLlib 对历史招聘数据以及求职者投递行为数据进行分类分析，构建预测模型，精准 预测不同职位的招聘热度趋势，例如预测某一新兴技术岗位在未来几个月内的需求增长情况，帮助招聘平台提前规划资源分 配（如推荐位分配、客服资源调配等），助力企业提前做好招聘准备，抢占人才市场先机。通过聚类分析对职位进行分组， 挖掘出具有相似特征（如相似的岗位要求、薪资范围、工作地点等）的职位群体，为招聘平台优化职位推荐算法提供参考， 提升求职者与职位的匹配精准度；同时为企业制定差异化招聘策略提供数据依据，助力企业发现潜在的人才市场机会，优化 招聘资源配置。

## **1.3**  **运行环境**

1.  Linux: Ubuntu 16.04

2.  Hadoop: 2.7.1

3.  JDK 版本：1.7 或以上版本

4.  Spark: 2.1.0

5.  Scala:2.1.0

6.  数据库：MySQL


# **2.** **数据集与数据预处理**

## **2.1**  **原始数据集**

### **2.1.1**  **数据集说明**

爬取工具：八爪鱼

 数据来源：Boss直聘[（https://www.zhipin.com/）](https://www.zhipin.com/%EF%BC%89)

数据量: 13198

数据字段：城市，关键词，职位，职位详情链接，地区，薪资范围，经验要求，学历要求，公司名称，公司详情链接， 公司类型，融资情况，公司规模，标签1，标签2，标签3，标签4，标签5，福利待遇，创建时间

### **2.1.2**   **原始数据集展示**

![](file:///C:\Users\17817\AppData\Local\Temp\ksohtml5180\wps2.png) 

  

## **2.2**  **数据预处理**

### **2.2.1**   **去除无用字段与重复行，添加id**

去除无用字段与重复行，并添加id

```python
df = df.rename(columns={'关键词': '岗位'}) 
# 删除冗余链接列
df.drop(columns=['职位详情链接', '公司详情链接', '职位', '地区','福利待遇','标签1','标签2','标签
3','标签4','标签5'], inplace=True)
# 数据去重
df.drop_duplicates(inplace=True) 
# 添加自增ID列
df.insert(0, 'id', range(1, len(df) + 1))
```

### **2.2.2**    **范围处理**

薪资：对薪资范围取中值处理。

```python
定义薪资提取函数
def extract_salary_midpoint(salary_str):
match = re.match(r'(\d+)-(\d+)K(?:·(\d+)薪)?', salary_str) 
if match:
lower, upper = int(match.group(1)), int(match.group(2)) 
return (lower + upper) / 2
return np.nan 
# 应用薪资提取
df['薪资范围'] = df['薪资范围'].apply(extract_salary_midpoint) 
df = df.rename(columns={'薪资范围': '薪资'})
# 清理无效数据
df = df.dropna(subset=['薪资'])
```

经验要求：对经验范围取最小值处理。

```python
def extract_min_experience(experience_str):
if experience_str == '1年以内 ':
return 0
elif experience_str == '经验不限 ':
return 0
match = re.match(r'(\d+)-?(\d*)年 ', experience_str) if match:
min_exp = int(match.group(1))
return min_exp
return np.nan
df['经验要求 '] = df['经验要求 '].apply(extract_min_experience) df = df.rename(columns={ '经验要求 ': '年限 '})
df = df.dropna(subset=[ '年限 '])
```

公司融资情况与公司规模处理

```python
def extract_scale(financing_info):
if not isinstance(financing_info, str):
return None
match = re.search(r'(\d+-\d+|\d+)人|(\d+)以上 ', financing_info)
if match:
return match.group(1) or match.group(2)
return None
def calculate_midpoint(scale):
if not scale:
return None
scale = scale.replace('人 ', '')  # 去除“人”字
if '-' in scale:
lower, upper = map(int, scale.split('-'))
return (lower + upper) // 2 elif scale.isdigit():
return int(scale)
elif '以上 ' in scale:
return int(scale.replace('以上 ', '')) else:
return None
def process_scale(row):
scale = row['公司规模 ']
if pd.isna(scale) or scale.strip() == '':
scale = extract_scale(row['融资情况 ']) return calculate_midpoint(scale)
df['公司规模 '] = df.apply(process_scale, axis=1)
df = df.drop(columns=['融资情况 '])
```

### **2.2.3**    **数据预处理的最终效果**

![|500](file:///C:\Users\17817\AppData\Local\Temp\ksohtml5180\wps7.png) 


## **2.3**   **数据上传**

### **2.3.1**   **启动HDFS**

```shell
cd /usr/local/hadoop
./sbin/start-all.sh
jps
```

![](file:///C:\Users\17817\AppData\Local\Temp\ksohtml5180\wps9.jpg) 

![](file:///C:\Users\17817\AppData\Local\Temp\ksohtml5180\wps10.jpg) 

### **2.3.2**    **上传数据至HDFS**

```shell
cd /usr/local/hadoop
./bin/hdfs dfs -mkdir -p /recruit
hdfs dfs -mkdir -p /recruit
hdfs dfs -put recruit.csv /recruit
hdfs dfs -cat /recruit/recruit.csv | head
```
![](file:///C:\Users\17817\AppData\Local\Temp\ksohtml5180\wps12.jpg) 


# **3.** **数据分析**

启动 Spark

```shell
./bin/spark-shell \
  --packages com.databricks:spark-csv_2.10:1.5.0
```

![](file:///C:\Users\17817\AppData\Local\Temp\ksohtml5180\wps14.jpg) 

定义数据 Schema，将列名替换为英文，便于分析

```shell
import org.apache.spark.sql.SQLContext
import org.apache.spark.sql.types._
import org.apache.spark.sql.functions._
import org.apache.spark.sql.UserDefinedFunction
import org.apache.spark.sql.Row
val sqlContext = new SQLContext(sc)
val schema = StructType(Seq(
  StructField("id", IntegerType, nullable = true),
  StructField("city", StringType, nullable = true),
  StructField("job", StringType, nullable = true),
  StructField("salary", DoubleType, nullable = true),
  StructField("experience", DoubleType, nullable = true),
  StructField("education", StringType, nullable = true),
  StructField("company", StringType, nullable = true),
  StructField("industry", StringType, nullable = true),
  StructField("company_size", IntegerType, nullable = true),
  StructField("post_time", StringType, nullable = true)
))
```

读取 CSV 文件载入数据，同时将临时表设置为recruit
```shell
val recruitDF = sqlContext.read.format("com.databricks.spark.csv").schema(schema).option("header", "true").load("hdfs:///recruit/recruit.csv")
recruitDF.registerTempTable("recruit")
```

## 3.1 Spark SQL数据分析

### **3.1.1**   查询各个行业最高薪资

分析目的 ：锁定顶尖高薪职位，激发求职者挑战高薪岗位的意愿，引导其向高薪职位所需技能和经验方向发展；同时促使企 业审视自身核心岗位的薪资竞争力，防止人才流失。

```shell
val maxSalaryPerJob = sqlContext.sql("SELECT job, MAX(salary) AS max_salary FROM recruit GROUP BY job ORDER BY max_salary DESC")
maxSalaryPerJob.show()
maxSalaryPerJob.write.format("com.databricks.spark.csv").option("header", "true").save("hdfs:///recruit/max_salary_per_job")
```

![](file:///C:\Users\17817\AppData\Local\Temp\ksohtml5180\wps20.png) 

```shell
hdfs dfs -cat /recruit/max_salary_per_job/part*
```

![[Pasted image 20250625110750.png|550]]
### **3.1.2**    **统计各岗位各城市薪资中位数**

分析目的 ：相较于平均值，中位数更能反映各岗位各城市薪资的真实集中水平，避免极端值干扰，为求职者提供更准确的薪资参考，帮助企业合理定价岗位薪酬。

```
import org.apache.spark.sql.expressions.{MutableAggregationBuffer, UserDefinedAggregateFunction}
object CollectListUDAF extends UserDefinedAggregateFunction {
  def inputSchema: StructType = StructType(StructField("value", DoubleType) :: Nil)
  def bufferSchema: StructType = StructType(StructField("list", ArrayType(DoubleType)) :: Nil)
  def dataType: DataType = ArrayType(DoubleType)
  def deterministic: Boolean = true
  
  def initialize(buffer: MutableAggregationBuffer): Unit = {
    buffer(0) = Seq.empty[Double]
  }
  
  def update(buffer: MutableAggregationBuffer, input: Row): Unit = {
    if (!input.isNullAt(0)) {
      val list = buffer.getAs[Seq[Double]](0)
      buffer(0) = list :+ input.getDouble(0)
    }
  }
  
  def merge(buffer1: MutableAggregationBuffer, buffer2: Row): Unit = {
    val list1 = buffer1.getAs[Seq[Double]](0)
    val list2 = buffer2.getAs[Seq[Double]](0)
    buffer1(0) = list1 ++ list2
  }
  
  def evaluate(buffer: Row): Any = {
    buffer.getSeq[Double](0)
  }
}
val medianUDF: UserDefinedFunction = udf { salaries: Seq[Double] =>
  val sorted = salaries.filter(_.isInstanceOf[Double]).map(_.asInstanceOf[Double]).sorted
  if (sorted.isEmpty) None
  else {
    val mid = sorted.length / 2
    if (sorted.length % 2 == 0) {
      Some((sorted(mid - 1) + sorted(mid)) / 2.0)
    } else {
      Some(sorted(mid))
    }
  }
}
sqlContext.udf.register("collect_list", CollectListUDAF)
val medianSalaryPerJobPerCity = sqlContext.sql("SELECT job, city, salary FROM recruit").groupBy("job", "city").agg(collect_list("salary").alias("salaries")).withColumn("median_salary", medianUDF(col("salaries"))).drop("salaries").orderBy("job", "median_salary")
medianSalaryPerJobPerCity.show(medianSalaryPerJobPerCity.count().toInt)
medianSalaryPerJobPerCity.write.format("com.databricks.spark.csv").option("header", "true").save("hdfs:///recruit/median_salary_per_job_per_city")
```

![[Pasted image 20250625153620.png|203]]

```
hdfs dfs -cat /recruit/median_salary_per_job_per_city/part*
```
  
![|345](file:///C:\Users\17817\AppData\Local\Temp\ksohtml5180\wps26.png) 

### **3.1.3**    **查询互联网行业薪资最高的** **top20**  **公司**

分析目的 ：为互联网行业求职者提供具有吸引力的优质雇主参考，助力其锁定目标企业；同时激励互联网企业提升薪资福利 水平和雇主品牌建设，以吸引更多优秀人才。

```
val topSalariesInInternetIndustry = sqlContext.sql(""" SELECT job, company, MAX(salary) AS max_salary FROM recruit
WHERE industry = '互联网' GROUP BY job, company
ORDER BY max_salary DESC LIMIT 20
""")
topSalariesInInternetIndustry.show()
topSalariesInInternetIndustry.write.format("csv").option("header", "true").save("hdfs:///recruit/top_salaries_in_internet_industry")
```
  
![|362](file:///C:\Users\17817\AppData\Local\Temp\ksohtml5180\wps28.jpg) 

```
hdfs dfs -cat /recruit/top_salaries_in_internet_industry/part*
```

![|388](file:///C:\Users\17817\AppData\Local\Temp\ksohtml5180\wps30.png) 

### **3.1.4**    **按月份统计岗位数量趋势**

分析目的 ：把握招聘市场动态变化规律，揭示不同月份岗位供需波动情况，为求职者规划求职时间提供依据，使其能在招聘 旺季增加就业机会；帮助企业提前规划招聘周期和人力配置，合理安排招聘预算和进度。

```
val jobTrendPerMonth = sqlContext.sql("""
SELECT DATE_FORMAT(post_time, 'yyyy-MM') AS month, COUNT(*) AS job_count FROM recruit
GROUP BY DATE_FORMAT(post_time, 'yyyy-MM')
ORDER BY month
""")
jobTrendPerMonth.show()
jobTrendPerMonth.write.format("csv").option("header", "true").save("hdfs:///recruit/job_trend_per_month")
```

![|131](file:///C:\Users\17817\AppData\Local\Temp\ksohtml5180\wps32.png) 

```
hdfs dfs -cat /recruit/job_trend_per_month/part*
```

![|284](file:///C:\Users\17817\AppData\Local\Temp\ksohtml5180\wps34.png) 

  
### **3.1.5**    **查询不同行业薪资的分布**

分析目的 ：了解各行业整体薪资竞争力和差异，为求职者在不同行业间的选择提供参考，引导人才合理流动；协助企业了解 所处行业薪资水平，为跨行业人才竞争策略制定提供数据支持。

```
object MedianUDAF extends UserDefinedAggregateFunction {
  def inputSchema: StructType = StructType(StructField("value", DoubleType) :: Nil)
  def bufferSchema: StructType = StructType(StructField("values", ArrayType(DoubleType)) :: Nil)
  def dataType: DataType = DoubleType
  def deterministic: Boolean = true
  def initialize(buffer: MutableAggregationBuffer): Unit = {
    buffer(0) = Seq.empty[Double]
  }
  def update(buffer: MutableAggregationBuffer, input: Row): Unit = {
    if (!input.isNullAt(0)) {
      val values = buffer.getAs[Seq[Double]](0)
      buffer(0) = values :+ input.getDouble(0)
    }
  }
  def merge(buffer1: MutableAggregationBuffer, buffer2: Row): Unit = {
    val values1 = buffer1.getAs[Seq[Double]](0)
    val values2 = buffer2.getAs[Seq[Double]](0)
    buffer1(0) = values1 ++ values2
  }
  def evaluate(buffer: Row): Any = {
    val values = buffer.getAs[Seq[Double]](0).sorted
    if (values.isEmpty) 0.0
    else {
      val mid = values.length / 2
      if (values.length % 2 == 0) {
        (values(mid - 1) + values(mid)) / 2.0
      } else {
        values(mid)
      }
    }
  }
}
sqlContext.udf.register("median", MedianUDAF)
val salaryDistributionByIndustry = sqlContext.sql("""
  SELECT 
    industry,
    MIN(salary) AS min_salary,
    ROUND(AVG(salary), 2) AS avg_salary,
    MAX(salary) AS max_salary,
    median(salary) AS median_salary
  FROM recruit
  GROUP BY industry
  ORDER BY avg_salary DESC
""")
salaryDistributionByIndustry.show()

```

![|325](file:///C:\Users\17817\AppData\Local\Temp\ksohtml5180\wps36.png) 

```
hdfs dfs -cat /recruit/salary_distribution_by_industry/part*
```

![[Pasted image 20250625155028.png|500]]


# 4. Flask 与 ECharts 数据可视化

## 4.1 开发环境

### 4.1.1 Falsk开发环境

主要利用 Flask（2.2.3） 搭建动态 Web 应用并结合 ECharts 进行前端界面可视化。

### 4.2 本部分功能

该部分主要是使用合适的前端模板可视化展示前面所获取每个部分的数据


## 4.2  统计各个行业的最高薪水

功能说明：根据行业进行筛选选出最高的薪水，然后生成直方图。

Flask 应用程序代码：
```python
from flask import Flask, render_template, jsonify
import subprocess
import pandas as pd
import json
import io

app = Flask(__name__)

def read_hdfs_file(path):
    """从HDFS读取文件内容"""
    try:
        # 使用hdfs dfs -cat命令读取文件
        cmd = f"hdfs dfs -cat {path}"
        result = subprocess.run(cmd, shell=True, capture_output=True, text=True)
        
        if result.returncode != 0:
            raise Exception(f"HDFS命令执行失败: {result.stderr}")
        
        return result.stdout
    except Exception as e:
        print(f"读取HDFS文件时出错: {e}")
        return None

@app.route('/')
def index():
    """首页"""
    return render_template('index.html')

@app.route('/salary-chart')
def salary_chart():
    """薪资数据可视化页面"""
    # 从HDFS读取薪资数据
    hdfs_path = "/recruit/max_salary_per_job/part*"
    content = read_hdfs_file(hdfs_path)
    
    if not content:
        return "无法读取HDFS数据", 500
    
    # 处理数据
    # 移除重复的标题行
    lines = content.strip().split('\n')
    header = lines[0]
    data_lines = [line for line in lines if line != header]
    
    # 创建DataFrame
    df = pd.read_csv(io.StringIO('\n'.join([header] + data_lines)))
    
    # 生成图表数据
    job_data = df.to_dict('records')
    
    return render_template('salary_chart.html', job_data=json.dumps(job_data))

if __name__ == '__main__':
    app.run(debug=True, host='0.0.0.0', port=5000)    

```

前端代码：
index.html
```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>薪资数据分析</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100 font-sans">
    <nav class="bg-white shadow-md">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <a href="#" class="flex-shrink-0 flex items-center">
                        <i class="fa fa-bar-chart text-blue-500 text-2xl mr-2"></i>
                        <span class="font-bold text-xl text-gray-900">薪资数据分析</span>
                    </a>
                </div>
                <div class="flex items-center">
                    <a href="/salary-chart" class="px-3 py-2 rounded-md text-sm font-medium text-blue-700 hover:text-blue-900">
                        <i class="fa fa-line-chart mr-1"></i> 薪资图表
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <div class="container mx-auto px-4 py-8">
        {% block content %}
        {% endblock %}
    </div>
</body>
</html>    

```

salary_chart.html
```html
{% extends 'index.html' %}
{% block content %}
<div class="container mx-auto px-4 py-8">
    <div class="bg-white rounded-lg shadow-md p-6 mb-8">
        <h1 class="text-2xl font-bold text-gray-900 mb-4">各职位最高薪资分布</h1>
        <p class="text-gray-600 mb-6">该图表展示了不同职位的最高薪资情况，帮助了解市场薪资水平。</p>
        
        <div class="h-[600px] w-full" id="salary-chart"></div>
    </div>
    
    <div class="bg-white rounded-lg shadow-md p-6">
        <h2 class="text-xl font-bold text-gray-900 mb-4">薪资数据详情</h2>
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                    <tr>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">职位</th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">最高薪资 (K)</th>
                    </tr>
                </thead>
                <tbody id="salary-table-body" class="bg-white divide-y divide-gray-200">
                    <!-- JavaScript 将填充此表格 -->
                </tbody>
            </table>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
<script>
    // 从Flask获取薪资数据
    var jobData = {{ job_data | safe }};
    
    // 准备图表数据
    var jobs = jobData.map(item => item.job);
    var salaries = jobData.map(item => parseFloat(item.max_salary));
    
    // 创建ECharts实例
    var salaryChart = echarts.init(document.getElementById('salary-chart'));
    
    // 配置图表选项
    var option = {
        title: {
            text: '各职位最高薪资分布',
            left: 'center',
            textStyle: {
                fontSize: 20,
                fontWeight: 'bold'
            }
        },
        tooltip: {
            trigger: 'axis',
            axisPointer: {
                type: 'shadow'
            },
            formatter: function(params) {
                return `${params[0].name}<br/>最高薪资: ${params[0].value}K`;
            }
        },
        grid: {
            left: '3%',
            right: '4%',
            bottom: '3%',
            containLabel: true
        },
        xAxis: {
            type: 'category',
            data: jobs,
            axisLabel: {
                interval: 0,
                rotate: 45,
                align: 'left',
                verticalAlign: 'top',
                padding: [0, 0, 0, 10],
                fontSize: 12
            }
        },
        yAxis: {
            type: 'value',
            name: '薪资 (K)',
            min: 0,
            axisLabel: {
                formatter: '{value}K'
            }
        },
        series: [{
            name: '最高薪资',
            type: 'bar',
            data: salaries,
            label: {
                show: true,
                position: 'top',
                formatter: '{c}K'
            },
            itemStyle: {
                color: '#4169E1'
            }
        }]
    };
    
    // 设置图表选项
    salaryChart.setOption(option);
    
    // 填充表格数据
    var tableBody = document.getElementById('salary-table-body');
    jobData.forEach(function(item) {
        var row = document.createElement('tr');
        row.className = 'hover:bg-gray-50 transition-colors';
        
        var jobCell = document.createElement('td');
        jobCell.className = 'px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900';
        jobCell.textContent = item.job;
        
        var salaryCell = document.createElement('td');
        salaryCell.className = 'px-6 py-4 whitespace-nowrap text-sm text-gray-500';
        salaryCell.textContent = item.max_salary + 'K';
        
        row.appendChild(jobCell);
        row.appendChild(salaryCell);
        tableBody.appendChild(row);
    });
    
    // 响应窗口大小变化
    window.addEventListener('resize', function() {
        salaryChart.resize();
    });
</script>
{% endblock %}    

```

可视化展示效果：
![[Pasted image 20250625211653.png|575]]

## 4.3 **统计各岗位各城市薪资中位数**

功能说明：相较于平均值，中位数更能反映各岗位各城市薪资的真实集中水平，同时为了展示各个城市的区别，使用了地图展示数据的形式。

Flask 应用程序代码：
```python
from flask import Flask, render_template, jsonify
import subprocess
import pandas as pd
import json
import io

app = Flask(__name__)

def read_hdfs_file(path):
    """从HDFS读取文件内容"""
    try:
        # 使用hdfs dfs -cat命令读取文件
        cmd = f"hdfs dfs -cat {path}"
        result = subprocess.run(cmd, shell=True, capture_output=True, text=True)
        
        if result.returncode != 0:
            raise Exception(f"HDFS命令执行失败: {result.stderr}")
        
        return result.stdout
    except Exception as e:
        print(f"读取HDFS文件时出错: {e}")
        return None

@app.route('/')
def index():
    """首页"""
    return render_template('index.html')

@app.route('/salary-chart')
def salary_chart():
    """薪资数据可视化页面"""
    # 从HDFS读取薪资数据
    hdfs_path = "/recruit/median_salary_per_job_per_city/part*"
    content = read_hdfs_file(hdfs_path)
    
    if not content:
        return "无法读取HDFS数据", 500
    
    # 处理数据
    # 移除重复的标题行
    lines = content.strip().split('\n')
    header = lines[0]
    data_lines = [line for line in lines if line != header]
    
    # 创建DataFrame
    df = pd.read_csv(io.StringIO('\n'.join([header] + data_lines)))
    
    # 生成图表数据
    salary_data = df.to_dict('records')
    
    return render_template('salary_chart.html', salary_data=json.dumps(salary_data))

if __name__ == '__main__':
    app.run(debug=True, host='0.0.0.0', port=5000)

```

前端代码：
index.html
```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>薪资数据分析</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100 font-sans">
    <nav class="bg-white shadow-md">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <a href="#" class="flex-shrink-0 flex items-center">
                        <i class="fa fa-bar-chart text-blue-500 text-2xl mr-2"></i>
                        <span class="font-bold text-xl text-gray-900">薪资数据分析</span>
                    </a>
                </div>
                <div class="flex items-center">
                    <a href="/salary-chart" class="px-3 py-2 rounded-md text-sm font-medium text-blue-700 hover:text-blue-900">
                        <i class="fa fa-map-marker mr-1"></i> 薪资地图
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <div class="container mx-auto px-4 py-8">
        {% block content %}
        <div class="bg-white rounded-lg shadow-md p-6">
            <h1 class="text-2xl font-bold text-gray-900 mb-4">欢迎使用薪资数据分析系统</h1>
            <p class="text-gray-600">本系统展示了不同城市Java后端岗位的中位数薪资分布，点击上方导航栏可查看详细数据可视化图表。</p>
        </div>
        {% endblock %}
    </div>
</body>
</html>    
```

salary_chart.html
```html
{% extends 'index.html' %}
{% block content %}
<div class="container mx-auto px-4 py-8">
    <div class="bg-white rounded-lg shadow-md p-6 mb-8">
        <h1 class="text-2xl font-bold text-gray-900 mb-4">Java后端薪资城市分布图</h1>
        <p class="text-gray-600 mb-6">该图表展示了不同城市Java后端开发岗位的中位数薪资情况。</p>
        
        <div class="h-[600px] w-full" id="salary-chart"></div>
    </div>
    
    <div class="bg-white rounded-lg shadow-md p-6">
        <h2 class="text-xl font-bold text-gray-900 mb-4">薪资数据详情</h2>
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                    <tr>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">职位</th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">城市</th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">中位数薪资 (K)</th>
                    </tr>
                </thead>
                <tbody id="salary-table-body" class="bg-white divide-y divide-gray-200">
                    <!-- JavaScript 将填充此表格 -->
                </tbody>
            </table>
        </div>
    </div>
</div>
<!-- 引入 ECharts 4.9.0 -->
<script src="https://cdn.jsdelivr.net/npm/echarts@4.9.0/dist/echarts.min.js"></script> 

<!-- 引入中国地图数据 -->
<script src="https://cdn.jsdelivr.net/npm/echarts@4.9.0/map/js/china.js"></script> 
<script>
    // 从Flask获取薪资数据
    var salaryData = {{ salary_data | safe }};
    
    // 城市经纬度数据
    var cityCoordinates = {
        '北京': [116.4074, 39.9042],
        '上海': [112.4737, 31.2304], // 修正上海经度(原121.4737可能导致显示问题)
        '广州': [113.2644, 23.1291],
        '深圳': [114.0579, 22.5431],
        '杭州': [120.1536, 30.2874],
        '南京': [118.7674, 32.0415],
        '成都': [104.0658, 30.5728],
        '武汉': [114.2985, 30.5843],
        '西安': [108.9480, 34.2631],
        '郑州': [113.6654, 34.7570],
        '长沙': [112.9822, 28.1127],
        '天津': [117.1901, 39.1256],
        '重庆': [106.5049, 29.5331],
        '厦门': [118.1016, 24.4864],
        '佛山': [113.1225, 23.0287]
    };
    
    // 准备地图数据
    var mapData = salaryData.map(item => {
        const city = item.city;
        const salary = parseFloat(item.median_salary);
        const coords = cityCoordinates[city] || [0, 0];
        
        return {
            name: city,
            value: [...coords, salary],
            salary: salary
        };
    }).filter(item => item.value[0] !== 0); // 过滤掉没有经纬度的城市
    
    // 创建ECharts实例
    var salaryChart = echarts.init(document.getElementById('salary-chart'));
    
    // 配置图表选项
    var option = {
        title: {
            text: 'Java后端薪资城市分布图',
            left: 'center',
            textStyle: {
                fontSize: 20,
                fontWeight: 'bold'
            }
        },
        tooltip: {
            trigger: 'item',
            formatter: function(params) {
                if (params.data && params.data.salary) {
                    return `${params.name}<br/>中位数薪资: ${params.data.salary}K`;
                }
                return params.name;
            }
        },
        visualMap: {
            min: 8,
            max: 15,
            range: [8, 15],
            calculable: true,
            orient: 'horizontal',
            left: 'center',
            bottom: '10%',
            text: ['高', '低'],
            inRange: {
                color: ['#e0ecf4', '#bfd3e6', '#9ebcda', '#8c96c6', '#8c6bb1', '#88419d', '#6e016b']
            }
        },
        geo: {
            map: 'china',
            roam: false,
            zoom: 1.2,
            label: {
                emphasis: {
                    show: false
                }
            },
            itemStyle: {
                normal: {
                    areaColor: '#f0f0f0',
                    borderColor: '#111'
                },
                emphasis: {
                    areaColor: '#e0e0e0'
                }
            }
        },
        series: [{
            name: '薪资水平',
            type: 'scatter',
            coordinateSystem: 'geo',
            data: mapData,
            symbolSize: function(val) {
                return val[2] * 2; // 根据薪资调整点的大小
            },
            label: {
                show: true,
                formatter: function(params) {
                    return params.data.name;
                },
                position: 'top',
                color: '#333',
                fontSize: 12
            },
            itemStyle: {
                color: '#4169E1'
            }
        }]
    };
    
    // 确保地图数据加载完成后再设置选项
    if (echarts.getMap('china')) {
        salaryChart.setOption(option);
    } else {
        // 处理地图加载失败的情况
        document.getElementById('salary-chart').innerHTML = '<div class="text-center text-red-500">地图数据加载失败，请检查网络连接</div>';
    }
    
    // 填充表格数据
    var tableBody = document.getElementById('salary-table-body');
    salaryData.forEach(function(item) {
        var row = document.createElement('tr');
        row.className = 'hover:bg-gray-50 transition-colors';
        
        var jobCell = document.createElement('td');
        jobCell.className = 'px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900';
        jobCell.textContent = item.job;
        
        var cityCell = document.createElement('td');
        cityCell.className = 'px-6 py-4 whitespace-nowrap text-sm text-gray-500';
        cityCell.textContent = item.city;
        
        var salaryCell = document.createElement('td');
        salaryCell.className = 'px-6 py-4 whitespace-nowrap text-sm text-gray-500';
        salaryCell.textContent = item.median_salary + 'K';
        
        row.appendChild(jobCell);
        row.appendChild(cityCell);
        row.appendChild(salaryCell);
        tableBody.appendChild(row);
    });
    
    // 响应窗口大小变化
    window.addEventListener('resize', function() {
        salaryChart.resize();
    });
</script>
{% endblock %}

```

可视化展示效果：
![[Pasted image 20250625213027.png|500]]

## 4.4  **查询互联网行业薪资最高的** **top20**  **公司**

功能说明：为互联网行业求职者提供具有吸引力的优质雇主参考，助力其锁定目标企业；挑选了互联网行业中的薪资前20的公司，并通过桑基图进行更好地展示。

Flask 应用程序代码：
```python
from flask import Flask, render_template, jsonify
import subprocess
import pandas as pd
import json
import io

app = Flask(__name__)

def read_hdfs_file(path):
    """从HDFS读取文件内容"""
    try:
        cmd = f"hdfs dfs -cat {path}"
        result = subprocess.run(cmd, shell=True, capture_output=True, text=True)
        
        if result.returncode != 0:
            raise Exception(f"HDFS命令执行失败: {result.stderr}")
        
        return result.stdout
    except Exception as e:
        print(f"读取HDFS文件时出错: {e}")
        return None

@app.route('/')
def index():
    """首页"""
    return render_template('index.html')

@app.route('/salary-chart')
def salary_chart():
    """薪资数据可视化页面"""
    # 从HDFS读取薪资数据
    hdfs_path = "/recruit/top_salaries_in_internet_industry/part*"
    content = read_hdfs_file(hdfs_path)
    
    if not content:
        return "无法读取HDFS数据", 500
    
    # 处理数据
    lines = content.strip().split('\n')
    header = lines[0]
    data_lines = [line for line in lines if line != header]  # 移除重复标题行
    
    # 创建DataFrame
    df = pd.read_csv(io.StringIO('\n'.join([header] + data_lines)))
    
    # 生成图表数据
    salary_data = df.to_dict('records')
    return render_template('salary_chart.html', salary_data=json.dumps(salary_data))

if __name__ == '__main__':
    app.run(debug=True, host='0.0.0.0', port=5000)
```

前端代码：
index.html
```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>薪资数据分析</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100 font-sans">
    <nav class="bg-white shadow-md">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <a href="#" class="flex-shrink-0 flex items-center">
                        <i class="fa fa-bar-chart text-blue-500 text-2xl mr-2"></i>
                        <span class="font-bold text-xl text-gray-900">薪资数据分析</span>
                    </a>
                </div>
                <div class="flex items-center">
                    <a href="/salary-chart" class="px-3 py-2 rounded-md text-sm font-medium text-blue-700 hover:text-blue-900">
                        <i class="fa fa-sitemap mr-1"></i> 高薪岗位分布
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <div class="container mx-auto px-4 py-8">
        {% block content %}
        <div class="bg-white rounded-lg shadow-md p-6">
            <h1 class="text-2xl font-bold text-gray-900 mb-4">互联网行业薪资数据分析</h1>
            <p class="text-gray-600">本平台通过Hadoop大数据分析，展示互联网行业各职位在不同公司的薪资分布情况，帮助您了解市场薪资水平。</p>
        </div>
        {% endblock %}
    </div>
</body>
</html>

```

salary_chart.html
```html
{% extends 'index.html' %}
{% block content %}
<div class="container mx-auto px-4 py-8">
    <div class="bg-white rounded-lg shadow-md p-6 mb-8">
        <h1 class="text-2xl font-bold text-gray-900 mb-4">互联网行业高薪岗位分布图</h1>
        <p class="text-gray-600 mb-6">该桑基图展示了不同职位在各公司的最高薪资分布，节点大小表示薪资水平，连线粗细表示薪资数值。</p>
        
        <div class="h-[700px] w-full" id="salary-chart"></div>
    </div>
    
    <div class="bg-white rounded-lg shadow-md p-6">
        <h2 class="text-xl font-bold text-gray-900 mb-4">薪资数据详情</h2>
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                    <tr>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">职位</th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">公司</th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">最高薪资 (K)</th>
                    </tr>
                </thead>
                <tbody id="salary-table-body" class="bg-white divide-y divide-gray-200">
                    <!-- JavaScript 将填充此表格 -->
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- 优先使用稳定的ECharts 5.x版本 -->
<script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
<script>
    // 从Flask获取薪资数据
    var salaryData = {{ salary_data | safe }};
    
    // 提取所有职位和公司作为桑基图节点
    var nodes = [];
    var jobSet = new Set();
    var companySet = new Set();
    
    salaryData.forEach(item => {
        jobSet.add(item.job);
        companySet.add(item.company);
    });
    
    // 构建节点列表（职位在前，公司在后）
    jobSet.forEach(job => {
        nodes.push({ name: job, category: 0 });
    });
    companySet.forEach(company => {
        nodes.push({ name: company, category: 1 });
    });
    
    // 构建边数据（薪资作为流量）
    var links = salaryData.map(item => {
        var sourceIndex = nodes.findIndex(node => node.name === item.job);
        var targetIndex = nodes.findIndex(node => node.name === item.company);
        return {
            source: sourceIndex,
            target: targetIndex,
            value: parseFloat(item.max_salary)
        };
    });
    
    // 构建节点类别名称
    var categories = [{ name: '职位' }, { name: '公司' }];
    
    // 创建ECharts实例
    var salaryChart = echarts.init(document.getElementById('salary-chart'));
    
    // 配置图表选项
    var option = {
        title: {
            text: '互联网行业高薪岗位桑基图',
            subtext: '职位 -> 公司 薪资流动',
            left: 'center',
            textStyle: {
                fontSize: 20,
                fontWeight: 'bold'
            }
        },
        tooltip: {
            trigger: 'item',
            formatter: function(params) {
                if (params.dataType === 'edge') {
                    return `${nodes[params.source].name} -> ${nodes[params.target].name}<br/>薪资: ${params.value}K`;
                }
                return params.name;
            }
        },
        toolbox: {
            feature: {
                dataView: { show: true },
                restore: { show: true },
                saveAsImage: { show: true }
            }
        },
        series: [{
            type: 'sankey',
            layout: 'none', // 不自动布局，使用节点默认位置
            data: nodes,
            links: links,
            categories: categories,
            itemStyle: {
                borderWidth: 1,
                borderColor: '#aaa'
            },
            lineStyle: {
                color: 'source',
                curveness: 0.5
            },
            label: {
                show: true,
                position: 'right',
                formatter: function(params) {
                    return params.name;
                }
            }
        }]
    };
    
    // 设置图表选项
    salaryChart.setOption(option);
    
    // 填充表格数据
    var tableBody = document.getElementById('salary-table-body');
    salaryData.forEach(function(item) {
        var row = document.createElement('tr');
        row.className = 'hover:bg-gray-50 transition-colors';
        
        var jobCell = document.createElement('td');
        jobCell.className = 'px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900';
        jobCell.textContent = item.job;
        
        var companyCell = document.createElement('td');
        companyCell.className = 'px-6 py-4 whitespace-nowrap text-sm text-gray-500';
        companyCell.textContent = item.company;
        
        var salaryCell = document.createElement('td');
        salaryCell.className = 'px-6 py-4 whitespace-nowrap text-sm text-gray-500';
        salaryCell.textContent = item.max_salary + 'K';
        
        row.appendChild(jobCell);
        row.appendChild(companyCell);
        row.appendChild(salaryCell);
        tableBody.appendChild(row);
    });
    
    // 响应窗口大小变化
    window.addEventListener('resize', function() {
        salaryChart.resize();
    });
</script>
{% endblock %}

```

可视化展示效果：
![[Pasted image 20250625213315.png]]

## 4.5 **按月份统计岗位数量趋势**

功能说明：按照时间维度统计岗位的趋势，同时通过折线图可视化岗位数量的变化。

Flask 应用程序代码：
```python
from flask import Flask, render_template, jsonify
import subprocess
import pandas as pd
import json
import io

app = Flask(__name__)

def read_hdfs_file(path):
    """从HDFS读取文件内容"""
    try:
        cmd = f"hdfs dfs -cat {path}"
        result = subprocess.run(cmd, shell=True, capture_output=True, text=True)
        
        if result.returncode != 0:
            raise Exception(f"HDFS命令执行失败: {result.stderr}")
        
        return result.stdout
    except Exception as e:
        print(f"读取HDFS文件时出错: {e}")
        return None

@app.route('/')
def index():
    """首页"""
    return render_template('index.html')

@app.route('/job-trend')
def job_trend():
    """职位趋势可视化页面"""
    # 从HDFS读取职位趋势数据
    hdfs_path = "/recruit/job_trend_per_month/part*"
    content = read_hdfs_file(hdfs_path)
    
    if not content:
        return "无法读取HDFS数据", 500
    
    # 处理数据 - 移除重复的标题行
    lines = content.strip().split('\n')
    header = lines[0]
    data_lines = [line for line in lines if line != header]
    
    # 创建DataFrame
    df = pd.read_csv(io.StringIO('\n'.join([header] + data_lines)))
    
    # 生成图表数据
    trend_data = df.to_dict('records')
    return render_template('job_trend.html', trend_data=json.dumps(trend_data))

if __name__ == '__main__':
    app.run(debug=True, host='0.0.0.0', port=5000)

```

前端代码：
index.html
```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>职位趋势分析</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100 font-sans">
    <nav class="bg-white shadow-md">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <a href="#" class="flex-shrink-0 flex items-center">
                        <i class="fa fa-bar-chart text-blue-500 text-2xl mr-2"></i>
                        <span class="font-bold text-xl text-gray-900">职位趋势分析</span>
                    </a>
                </div>
                <div class="flex items-center">
                    <a href="/job-trend" class="px-3 py-2 rounded-md text-sm font-medium text-blue-700 hover:text-blue-900">
                        <i class="fa fa-line-chart mr-1"></i> 职位趋势
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <div class="container mx-auto px-4 py-8">
        {% block content %}
        <div class="bg-white rounded-lg shadow-md p-6">
            <h1 class="text-2xl font-bold text-gray-900 mb-4">互联网职位趋势分析</h1>
            <p class="text-gray-600">本平台展示了2024年各月份的互联网职位数量趋势，帮助您了解行业人才需求变化。</p>
        </div>
        {% endblock %}
    </div>
</body>
</html>
```

job_trend.html
```html
{% extends 'index.html' %}
{% block content %}
<div class="container mx-auto px-4 py-8">
    <div class="bg-white rounded-lg shadow-md p-6 mb-8">
        <h1 class="text-2xl font-bold text-gray-900 mb-4">2024年互联网职位数量趋势</h1>
        <p class="text-gray-600 mb-6">该面积图展示了2024年各月份的互联网职位数量变化趋势，面积大小反映了职位数量的多少。</p>
        
        <div class="h-[600px] w-full" id="job-trend-chart"></div>
    </div>
    
    <div class="bg-white rounded-lg shadow-md p-6">
        <h2 class="text-xl font-bold text-gray-900 mb-4">职位数量详情</h2>
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                    <tr>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">月份</th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">职位数量</th>
                    </tr>
                </thead>
                <tbody id="trend-table-body" class="bg-white divide-y divide-gray-200">
                    <!-- JavaScript 将填充此表格 -->
                </tbody>
            </table>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script> 
<script>
    // 从Flask获取职位趋势数据
    var trendData = {{ trend_data | safe }};
    
    // 准备图表数据
    var months = trendData.map(item => item.month);
    var jobCounts = trendData.map(item => parseInt(item.job_count));
    
    // 创建ECharts实例
    var trendChart = echarts.init(document.getElementById('job-trend-chart'));
    
    // 配置图表选项 - 使用面积图
    var option = {
        title: {
            text: '2024年互联网职位数量趋势',
            left: 'center',
            textStyle: {
                fontSize: 20,
                fontWeight: 'bold'
            }
        },
        tooltip: {
            trigger: 'axis',
            formatter: function(params) {
                return `${params[0].name}月<br/>职位数量: ${params[0].value}个`;
            }
        },
        legend: {
            data: ['职位数量']
        },
        grid: {
            left: '3%',
            right: '4%',
            bottom: '3%',
            containLabel: true
        },
        xAxis: {
            type: 'category',
            boundaryGap: false,
            data: months,
            axisLabel: {
                rotate: 45,
                align: 'right'
            }
        },
        yAxis: {
            type: 'value',
            name: '职位数量',
            min: 0,
            axisLabel: {
                formatter: '{value} 个'
            }
        },
        series: [{
            name: '职位数量',
            type: 'line',
            stack: '总量',
            areaStyle: {
                color: {
                    type: 'linear',
                    x: 0,
                    y: 0,
                    x2: 0,
                    y2: 1,
                    colorStops: [{
                        offset: 0,
                        color: 'rgba(65, 105, 225, 0.5)' // 蓝色透明
                    }, {
                        offset: 1,
                        color: 'rgba(65, 105, 225, 0.05)' // 浅蓝色透明
                    }]
                }
            },
            data: jobCounts,
            label: {
                show: true,
                position: 'top'
            },
            itemStyle: {
                color: '#4169E1' // 蓝色
            }
        }]
    };
    
    // 设置图表选项
    trendChart.setOption(option);
    
    // 填充表格数据
    var tableBody = document.getElementById('trend-table-body');
    trendData.forEach(function(item) {
        var row = document.createElement('tr');
        row.className = 'hover:bg-gray-50 transition-colors';
        
        var monthCell = document.createElement('td');
        monthCell.className = 'px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900';
        monthCell.textContent = item.month;
        
        var countCell = document.createElement('td');
        countCell.className = 'px-6 py-4 whitespace-nowrap text-sm text-gray-500';
        countCell.textContent = item.job_count + ' 个';
        
        row.appendChild(monthCell);
        row.appendChild(countCell);
        tableBody.appendChild(row);
    });
    
    // 响应窗口大小变化
    window.addEventListener('resize', function() {
        trendChart.resize();
    });
</script>
{% endblock %}

```

可视化展示结果：

![[Pasted image 20250625213818.png|575]]

## 4.6 **查询不同行业薪资的分布**

功能说明：本功能通过统计不同行业薪资的最低薪资、平均薪资、最高薪资和中位数薪资，查看行业潜力。同时通过雷达图可视化结果

Flask 应用程序代码：
```python
from flask import Flask, render_template, jsonify
import subprocess
import pandas as pd
import json
import io

app = Flask(__name__)

def read_hdfs_file(path):
    """从HDFS读取文件内容"""
    try:
        cmd = f"hdfs dfs -cat {path}"
        result = subprocess.run(cmd, shell=True, capture_output=True, text=True)
        
        if result.returncode != 0:
            raise Exception(f"HDFS命令执行失败: {result.stderr}")
        
        return result.stdout
    except Exception as e:
        print(f"读取HDFS文件时出错: {e}")
        return None

@app.route('/')
def index():
    """首页"""
    return render_template('index.html')

@app.route('/industry-salary')
def industry_salary():
    """行业薪资分布可视化页面"""
    # 从HDFS读取薪资数据
    hdfs_path = "/recruit/salary_distribution_by_industry/part*"
    content = read_hdfs_file(hdfs_path)
    
    if not content:
        return "无法读取HDFS数据", 500
    
    # 处理数据 - 移除重复的标题行
    lines = content.strip().split('\n')
    header = lines[0]
    data_lines = [line for line in lines if line != header]
    
    # 创建DataFrame
    df = pd.read_csv(io.StringIO('\n'.join([header] + data_lines)))
    
    # 选择前15个行业
    selected_industries = df.head(15)
    
    # 生成图表数据
    industry_data = selected_industries.to_dict('records')
    return render_template('industry_salary.html', industry_data=json.dumps(industry_data))

if __name__ == '__main__':
    app.run(debug=True, host='0.0.0.0', port=5000)
```

前端代码：
index.html
```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>行业薪资数据分析</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100 font-sans">
    <nav class="bg-white shadow-md">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <a href="#" class="flex-shrink-0 flex items-center">
                        <i class="fa fa-bar-chart text-blue-500 text-2xl mr-2"></i>
                        <span class="font-bold text-xl text-gray-900">行业薪资数据分析</span>
                    </a>
                </div>
                <div class="flex items-center">
                    <a href="/industry-salary" class="px-3 py-2 rounded-md text-sm font-medium text-blue-700 hover:text-blue-900">
                        <i class="fa fa-pie-chart mr-1"></i> 薪资分布
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <div class="container mx-auto px-4 py-8">
        {% block content %}
        <div class="bg-white rounded-lg shadow-md p-6">
            <h1 class="text-2xl font-bold text-gray-900 mb-4">行业薪资分布分析</h1>
            <p class="text-gray-600">本平台展示了不同行业的薪资分布情况，包括最低薪资、平均薪资、最高薪资和中位数薪资。</p>
        </div>
        {% endblock %}
    </div>
</body>
</html>

```

industry_salary.html
```html
{% extends 'index.html' %}
{% block content %}
<div class="container mx-auto px-4 py-8">
    <div class="bg-white rounded-lg shadow-md p-6 mb-8">
        <h1 class="text-2xl font-bold text-gray-900 mb-4">各行业薪资分布雷达图</h1>
        <p class="text-gray-600 mb-6">该雷达图展示了不同行业的薪资分布情况，包括最低薪资、平均薪资、最高薪资和中位数薪资，帮助您全面了解各行业薪资水平。</p>
        
        <div class="h-[700px] w-full" id="salary-radar-chart"></div>
    </div>
    
    <div class="bg-white rounded-lg shadow-md p-6">
        <h2 class="text-xl font-bold text-gray-900 mb-4">行业薪资数据详情</h2>
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                    <tr>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">行业</th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">最低薪资 (K)</th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">平均薪资 (K)</th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">最高薪资 (K)</th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">中位数薪资 (K)</th>
                    </tr>
                </thead>
                <tbody id="salary-table-body" class="bg-white divide-y divide-gray-200">
                    <!-- JavaScript 将填充此表格 -->
                </tbody>
            </table>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script> 
<script>
    // 从Flask获取行业薪资数据
    var industryData = {{ industry_data | safe }};
    
    // 提取薪资指标作为雷达图维度
    var indicators = ['最低薪资', '平均薪资', '最高薪资', '中位数薪资'];
    
    // 准备雷达图数据
    var radarData = industryData.map(item => {
        return {
            name: item.industry,
            value: [
                parseFloat(item.min_salary),
                parseFloat(item.avg_salary),
                parseFloat(item.max_salary),
                parseFloat(item.median_salary)
            ]
        };
    });
    
    // 计算各指标的最大值，用于雷达图半径缩放
    var maxValues = [0, 0, 0, 0];
    radarData.forEach(data => {
        data.value.forEach((val, index) => {
            if (val > maxValues[index]) {
                maxValues[index] = val;
            }
        });
    });
    
    // 创建ECharts实例
    var radarChart = echarts.init(document.getElementById('salary-radar-chart'));
    
    // 配置图表选项 - 使用雷达图
    var option = {
        title: {
            text: '各行业薪资分布雷达图',
            left: 'center',
            textStyle: {
                fontSize: 20,
                fontWeight: 'bold'
            }
        },
        tooltip: {
            trigger: 'item',
            formatter: function(params) {
                var tip = `<div style="font-size:14px;font-weight:bold">${params.name}</div>`;
                params.value.forEach((val, index) => {
                    tip += `<div>${indicators[index]}: ${val}K</div>`;
                });
                return tip;
            }
        },
        legend: {
            data: radarData.map(item => item.name),
            orient: 'vertical',
            right: 10,
            top: 'middle'
        },
        radar: {
            indicator: indicators.map(indicator => ({
                name: indicator,
                max: Math.ceil(maxValues[indicators.indexOf(indicator)] * 1.1) // 增加10%作为边距
            })),
            center: ['50%', '50%'],
            radius: ['30%', '75%'],
            shape: 'polygon',
            splitLine: {
                lineStyle: {
                    color: '#999'
                }
            },
            axisLine: {
                lineStyle: {
                    color: '#666'
                }
            }
        },
        series: [{
            type: 'radar',
            data: radarData.map(item => ({
                name: item.name,
                value: item.value,
                areaStyle: {
                    opacity: 0.2
                },
                lineStyle: {
                    width: 2
                }
            }))
        }]
    };
    
    // 设置图表选项
    radarChart.setOption(option);
    
    // 填充表格数据
    var tableBody = document.getElementById('salary-table-body');
    industryData.forEach(function(item) {
        var row = document.createElement('tr');
        row.className = 'hover:bg-gray-50 transition-colors';
        
        var industryCell = document.createElement('td');
        industryCell.className = 'px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900';
        industryCell.textContent = item.industry;
        
        var minCell = document.createElement('td');
        minCell.className = 'px-6 py-4 whitespace-nowrap text-sm text-gray-500';
        minCell.textContent = item.min_salary + 'K';
        
        var avgCell = document.createElement('td');
        avgCell.className = 'px-6 py-4 whitespace-nowrap text-sm text-gray-500';
        avgCell.textContent = item.avg_salary + 'K';
        
        var maxCell = document.createElement('td');
        maxCell.className = 'px-6 py-4 whitespace-nowrap text-sm text-gray-500';
        maxCell.textContent = item.max_salary + 'K';
        
        var medianCell = document.createElement('td');
        medianCell.className = 'px-6 py-4 whitespace-nowrap text-sm text-gray-500';
        medianCell.textContent = item.median_salary + 'K';
        
        row.appendChild(industryCell);
        row.appendChild(minCell);
        row.appendChild(avgCell);
        row.appendChild(maxCell);
        row.appendChild(medianCell);
        tableBody.appendChild(row);
    });
    
    // 响应窗口大小变化
    window.addEventListener('resize', function() {
        radarChart.resize();
    });
</script>
{% endblock %}
```

可视化展示结果：
![[Pasted image 20250625214225.png|525]]